# LunSim Components

This document describes the components available in LunSim, with a focus on the core components needed for the initial POC.

## Resource Types

### POC Core Resources
- **Electricity**: Power for all systems
- **Oxygen**: For life support
- **Water**: For life support

### Future Resources (Post-POC)
- **Regolith**: Raw lunar soil material
- **Metals**: Processed from regolith
- **Food**: For crew sustenance
- **Heat**: Generated by systems
- **Waste**: Must be processed or stored
- **CO2**: Produced by crew, must be scrubbed

## POC Components

### Core POC Components

These components form the foundation of the Proof of Concept:

#### Solar Panel
- **Inputs**: None
- **Outputs**: Electricity
- **Properties**:
  - Generation Rate: 1.5 kW
  - Visual feedback on production
- **Implementation Priority**: 1 (First component to implement)

#### Battery
- **Inputs**: Electricity
- **Outputs**: Electricity
- **Properties**:
  - Storage Capacity: 50 kWh
  - Charge/Discharge Rate: 5 kW
- **Implementation Priority**: 2

#### Habitat Module
- **Inputs**: Electricity, Oxygen, Water
- **Outputs**: None (POC version)
- **Properties**:
  - Power Usage: 2 kW
  - Oxygen Usage: 1 kg/day
  - Water Usage: 2.5 L/day
- **Implementation Priority**: 3

### Implementation Steps (Per Component)

For each component, follow these implementation steps:

1. Create basic GraphElement subclass
2. Add resource ports (inputs/outputs)
3. Implement simulation logic
4. Add visual feedback
5. Test connections and resource flow

## Future Components (Post-POC)

### Life Support Systems

#### Oxygen Generator
- **Inputs**: Regolith, Electricity
- **Outputs**: Oxygen
- **Properties**:
  - Production Rate: 1 kg O₂/hour
  - Power Usage: 2 kW
  - Efficiency: 80%

#### Water Recycler
- **Inputs**: Waste Water, Electricity
- **Outputs**: Clean Water
- **Properties**:
  - Processing Rate: 10 L/hour
  - Power Usage: 1 kW
  - Recovery Efficiency: 95%

### Power Systems

#### RTG (Radioisotope Thermoelectric Generator)
- **Inputs**: None
- **Outputs**: Electricity, Heat
- **Properties**:
  - Generation Rate: 0.3 kW (constant)
  - Lifespan: 14 years
  - Size: 1m³
  - Expensive but reliable

### Resource Production

#### Regolith Harvester
- **Inputs**: Electricity
- **Outputs**: Regolith
- **Properties**:
  - Harvesting Rate: 50 kg/hour
  - Power Usage: 3 kW
  - Range: 100m from base

#### Water Extractor
- **Inputs**: Ice-Rich Regolith, Electricity
- **Outputs**: Water, Dry Regolith
- **Properties**:
  - Extraction Rate: 5 L/hour
  - Power Usage: 4 kW
  - Efficiency: 85%

## Connection Types

- **Power Connections**: Transfer electricity
- **Fluid Connections**: Transfer liquids and gases
- **Material Connections**: Transfer solid resources (post-POC)

## Implementation Examples

### Solar Panel Implementation (POC)

```gdscript
class_name SolarPanel
extends BaseComponent

func _init():
    component_type = "Solar Panel"
    
func setup_ports():
    outputs["electricity"] = ResourcePort.new(ResourceType.ELECTRICITY, false, self)
    # Add the port as child and position it
    var port_control = Control.new()
    port_control.add_child(outputs["electricity"])
    add_child(port_control)
    port_control.rect_position = Vector2(rect_size.x - 20, rect_size.y / 2)
    
func process_simulation(delta):
    if is_active:
        # In POC, just generate a fixed amount
        outputs["electricity"].set_value(1.5)
```

### Battery Implementation (POC)

```gdscript
class_name Battery
extends BaseComponent

var stored_energy = 0.0
var capacity = 50.0

func _init():
    component_type = "Battery"
    
func setup_ports():
    inputs["electricity_in"] = ResourcePort.new(ResourceType.ELECTRICITY, true, self)
    outputs["electricity_out"] = ResourcePort.new(ResourceType.ELECTRICITY, false, self)
    
    # Add and position ports
    # ...
    
func process_simulation(delta):
    if is_active:
        # Store input energy
        var input_amount = inputs["electricity_in"].current_value * delta
        stored_energy = min(stored_energy + input_amount, capacity)
        
        # Output energy
        outputs["electricity_out"].set_value(min(5.0, stored_energy))
        stored_energy = max(0, stored_energy - outputs["electricity_out"].current_value * delta)
```

## Visual Design

Each component will have:
- Clear icon indicating purpose
- Color coding by system type
- Connection points with visual indicators
- Status indicators showing operational state

## Testing Checklist

For each component:
- [ ] Creates and displays correctly in the building view
- [ ] Ports are properly positioned and can be connected
- [ ] Process logic correctly handles resource production/consumption
- [ ] Visual feedback works correctly
- [ ] Component behaves as expected when resources are limited 